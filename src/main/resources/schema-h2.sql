create table if not exists cart
(
    id bigint generated by default as identity,
    primary key (id)
);

create table if not exists cart_products
(
    cart_id     bigint not null,
    products_id bigint not null
);

create table if not exists category
(
    id            bigint generated by default as identity,
    category_name varchar(32) not null,
    primary key (id)
);

create table if not exists products
(
    id             bigint generated by default as identity,
    image_location varchar(384),
    price          decimal(19, 2) not null check (price >= 0),
    quantity       integer check (quantity >= 0),
    title          varchar(255)   not null,
    category_id    bigint         not null,
    primary key (id)
);

create table if not exists reviews
(
    id         bigint generated by default as identity,
    comment    varchar(384) not null,
    rating     integer      not null check (rating >= 1 AND rating <= 5),
    user_id    bigint       not null,
    product_id bigint       not null,
    primary key (id)
);

create table if not exists users
(
    id         bigint generated by default as identity,
    email      varchar(255) not null,
    first_name varchar(100) not null,
    last_name  varchar(100) not null,
    password   varchar(255) not null,
    role       varchar(25)  not null,
    status     varchar(25)  not null,
    cart_id    bigint       not null,
    primary key (id)
);

alter table cart_products
    add constraint if not exists FK_CART_PRODUCTS_PRODUCTS foreign key (products_id) references products;
alter table cart_products
    add constraint if not exists FK_CART_PRODUCTS_CART foreign key (cart_id) references cart;
alter table products
    add constraint if not exists FK_PRODUCTS_CART foreign key (category_id) references category;
alter table reviews
    add constraint if not exists FK_REVIEWS_USERS foreign key (user_id) references users;
alter table reviews
    add constraint if not exists FK_REVIEWS_PRODUCTS foreign key (product_id) references products;
alter table users
    add constraint if not exists FK_USERS_CART foreign key (cart_id) references cart;

create index if not exists IX_CATEGORY_CATEGORY_NAME on category (category_name);
create index if not exists IX_USERS_EMAIL on users (email);

insert into CART (ID)
values (1);
insert into CART (ID)
values (2);

insert into USERS (ID, EMAIL, FIRST_NAME, LAST_NAME, PASSWORD, ROLE, STATUS, CART_ID)
values (1, 'admin@mail.com', 'Ivan', 'Petrov', '$2a$12$GRDGUDo8RLHGjTZ0MraEMOWsUutwHste2eRxlR/HJeTU9e1q9OYIq', 'ADMIN',
        'ACTIVE', 1);

insert into USERS (ID, EMAIL, FIRST_NAME, LAST_NAME, PASSWORD, ROLE, STATUS, CART_ID)
values (2, 'user@mail.com', 'Petr', 'Ivanov', '$2a$10$wMI7.0yLQIaDC17XMsEfcutUFlX4.7dJSn3cXDLXfECVhzJqtkjsS', 'USER',
        'ACTIVE', 2);

insert into CATEGORY (ID, CATEGORY_NAME)
values (1, 'Laptop');
insert into CATEGORY (ID, CATEGORY_NAME)
values (2, 'Smartphone');
insert into CATEGORY (ID, CATEGORY_NAME)
values (3, 'Camera');
insert into CATEGORY (ID, CATEGORY_NAME)
values (4, 'CPU');

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (1, 'https://avatars.mds.yandex.net/get-mpic/4737085/img_id3166316089522937453.jpeg/orig', 1047.99, 0,
        'Nikon Z 5 Camera Body', 3);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (2,
        'https://c.dns-shop.ru/thumb/st1/fit/0/0/a582aa8b497124d972b8c6d36d6e4962/c201023fee63375d614103f3eb86c77160656dae59094cd22a883302c5144fbc.jpg.webp',
        799.99, 4, 'Apple iPhone 13 128 ГБ Black', 2);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (3,
        'https://c.dns-shop.ru/thumb/st1/fit/0/0/c5dd7c073f912da6a64201d62a544578/93ba7a81a786695bdf44bb60000b82231d2c42bdddbb48c877cb0b559af6f608.jpg.webp',
        799.99, 6, 'Apple iPhone 13 128 ГБ Blue', 2);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (4,
        'https://c.dns-shop.ru/thumb/st1/fit/0/0/b4c4c6b8642a1090ba4c0aebec23e65b/2759fa04e8a60c6642cfa9533c48b696b838cd9bad02ac2c61d527abb9848f57.jpg.webp',
        999.49, 3, '17.3" MSI GF75 Thin 10SC-083XRU', 1);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (5,
        'https://c.dns-shop.ru/thumb/st4/fit/0/0/293f552f49e530570fbf5bb75828cd30/42e6cb0e0dfe2df6af8a70cf5954a322b922d8442094ccda2edb4b03e955e770.jpg.webp',
        249.99, 9, '6.67" POCO X3 Pro 128 ГБ', 2);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (6, 'https://media.ldlc.com/r1600/ld/products/00/05/91/49/LD0005914925_1.jpg', 299.99, 7,
        'Intel Core i5-12600 BOX',
        4);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (7,
        'https://c.dns-shop.ru/thumb/st4/fit/0/0/81e49d24c565b473215b55672254838c/7fcc534f0ccf499e39a6808c96c5545ac46887668dc6853e0c8ea90ab872be84.jpg.webp',
        1799.99, 5, '17.3" Lenovo Legion 5 17ACH6H', 1);

insert into PRODUCTS (ID, IMAGE_LOCATION, PRICE, QUANTITY, TITLE, CATEGORY_ID)
values (8,
        'https://c.dns-shop.ru/thumb/st4/fit/0/0/3bf5169546fbf4e686dc53e357b7bd7f/d3910cbd4eb7559ac21a8b840a00d2f7cd1be301ae930f8dda6d07cccd3962ef.jpg.webp',
        499.99, 9, '15.6" Dell Vostro 3500-5698', 1);

insert into REVIEWS (ID, COMMENT, RATING, USER_ID, PRODUCT_ID)
values (1, 'Прекрасное устройство! Держит заряд двое суток. Однозначно стоит своих денег.', 5, 2, 2);
